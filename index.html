<style>
  /* Add this inside your existing <style> tag */

  /* Summary page container */
  #summaryPage {
    max-width: 700px;
    margin: 40px auto;
    padding: 20px 24px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    display: none;
  }

  #summaryPage h2 {
    color: #1a73e8;
    text-align: center;
    font-weight: 700;
    margin-bottom: 24px;
  }

  /* Grid layout for summary items */
  #summaryList {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px 32px;
  }

  .summary-item {
    padding: 14px 18px;
    border-radius: 10px;
    background: #f5f8ff;
    box-shadow: inset 0 0 5px rgba(26, 115, 232, 0.15);
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .summary-item.missing {
    background: #ffdddd;
    border: 2px solid #d32f2f;
    color: #b71c1c;
    font-weight: 700;
  }

  .summary-item .title {
    font-size: 0.9rem;
    font-weight: 600;
    color: #1a73e8;
    margin-bottom: 6px;
    text-transform: uppercase;
  }

  .summary-item .vote {
    font-size: 1.1rem;
    color: #333;
  }

  /* Button container for confirm/back */
  #summaryButtons {
    margin-top: 36px;
    text-align: center;
  }

  #summaryButtons button {
    margin: 0 12px;
    padding: 14px 32px;
    font-size: 1.1rem;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-weight: 700;
    transition: background-color 0.3s;
  }

  #confirmBtn {
    background-color: #1a73e8;
    color: white;
  }

  #confirmBtn:hover {
    background-color: #155ab6;
  }

  #backBtn {
    background-color: #ccc;
    color: #333;
  }

  #backBtn:hover {
    background-color: #999;
    color: white;
  }
</style>

<script>
  // Keep your existing names and superlatives arrays as is

  const form = document.getElementById('superlativeForm');
  const dropdowns = [];

  // Add first dropdown for user identity
  const userGroup = document.createElement('div');
  userGroup.className = 'form-group';
  const userLabel = document.createElement('label');
  userLabel.htmlFor = 'userSelect';

  const userTitle = document.createElement('div');
  userTitle.className = 'superlative-title';
  userTitle.textContent = "What's up bitch!!! Who are you";

  userLabel.appendChild(userTitle);
  userGroup.appendChild(userLabel);

  const userSelect = document.createElement('select');
  userSelect.id = 'userSelect';
  userSelect.name = 'user';
  userSelect.innerHTML = `<option value="">-- Select your name --</option>` + names.map(name => `<option value="${name}">${name}</option>`).join('');
  userGroup.appendChild(userSelect);

  form.insertBefore(userGroup, form.firstChild);

  dropdowns.push(userSelect);

  // Create dropdowns for superlatives
  superlatives.forEach((desc, i) => {
    const group = document.createElement('div');
    group.className = 'form-group';

    const label = document.createElement('label');
    label.htmlFor = `dropdown${i}`;

    const titleLine = document.createElement('div');
    titleLine.className = 'superlative-title';
    titleLine.textContent = 'MOST LIKELY TO...';

    const descLine = document.createElement('div');
    descLine.className = 'superlative-desc';
    descLine.textContent = desc;

    label.appendChild(titleLine);
    label.appendChild(descLine);
    group.appendChild(label);

    const select = document.createElement('select');
    select.id = `dropdown${i}`;
    select.name = `superlative${i + 1}`;
    select.innerHTML = `<option value="">-- Select a nominee --</option>` + names.map(name => `<option value="${name}">${name}</option>`).join('');
    group.appendChild(select);

    dropdowns.push(select);
    form.insertBefore(group, form.lastElementChild);
  });

  // Apply unique selection rules to all dropdowns
  dropdowns.forEach(dropdown => {
    dropdown.addEventListener('change', updateDropdowns);
  });

  function updateDropdowns() {
    const selected = dropdowns.map(d => d.value).filter(Boolean);
    dropdowns.forEach(dropdown => {
      const current = dropdown.value;
      Array.from(dropdown.options).forEach(option => {
        if (option.value && option.value !== current) {
          option.disabled = selected.includes(option.value);
        } else {
          option.disabled = false;
        }
      });
    });
  }

  // Remove required attributes, allow partial submission
  dropdowns.forEach(d => d.required = false);

  // Add summary page elements dynamically
  const summaryPage = document.createElement('div');
  summaryPage.id = 'summaryPage';

  const summaryTitle = document.createElement('h2');
  summaryTitle.textContent = 'Review Your Votes';
  summaryPage.appendChild(summaryTitle);

  const summaryList = document.createElement('div');
  summaryList.id = 'summaryList';
  summaryPage.appendChild(summaryList);

  const summaryButtons = document.createElement('div');
  summaryButtons.id = 'summaryButtons';

  const backBtn = document.createElement('button');
  backBtn.id = 'backBtn';
  backBtn.type = 'button';
  backBtn.textContent = 'Go Back & Edit';
  summaryButtons.appendChild(backBtn);

  const confirmBtn = document.createElement('button');
  confirmBtn.id = 'confirmBtn';
  confirmBtn.type = 'button';
  confirmBtn.textContent = 'Confirm & Submit';
  summaryButtons.appendChild(confirmBtn);

  summaryPage.appendChild(summaryButtons);
  document.body.insertBefore(summaryPage, document.getElementById('thankYouMessage'));

  // Hide form and show summary on submit
  form.addEventListener('submit', e => {
    e.preventDefault();
    showSummary();
  });

  function showSummary() {
    summaryList.innerHTML = '';

    // Show user name first
    const userVote = userSelect.value;
    const userItem = document.createElement('div');
    userItem.className = userVote ? 'summary-item' : 'summary-item missing';

    const userTitle = document.createElement('div');
    userTitle.className = 'title';
    userTitle.textContent = "Who's submitting?";
    const userVoteDiv = document.createElement('div');
    userVoteDiv.className = 'vote';
    userVoteDiv.textContent = userVote || "No selection";

    userItem.appendChild(userTitle);
    userItem.appendChild(userVoteDiv);
    summaryList.appendChild(userItem);

    // Show all superlatives summary
    superlatives.forEach((desc, i) => {
      const vote = dropdowns[i+1].value; // +1 because first is userSelect

      const item = document.createElement('div');
      item.className = vote ? 'summary-item' : 'summary-item missing';

      const titleDiv = document.createElement('div');
      titleDiv.className = 'title';
      titleDiv.textContent = `Most likely to... ${desc}`;

      const voteDiv = document.createElement('div');
      voteDiv.className = 'vote';
      voteDiv.textContent = vote || 'No selection';

      item.appendChild(titleDiv);
      item.appendChild(voteDiv);
      summaryList.appendChild(item);
    });

    form.style.display = 'none';
    summaryPage.style.display = 'block';
    document.getElementById('thankYouMessage').style.display = 'none';
  }

  backBtn.addEventListener('click', () => {
    summaryPage.style.display = 'none';
    form.style.display = 'flex';
  });

  confirmBtn.addEventListener('click', () => {
    submitFinal();
  });

  // Function to submit to Google
  function submitFinal() {
    const formData = new FormData();

    dropdowns.forEach((d, i) => {
      // Use keys like 'user' and 'superlative1', 'superlative2' etc
      const key = i === 0 ? 'user' : `superlative${i}`;
      formData.append(key, d.value || '');
    });

    const scriptURL = "https://script.google.com/macros/s/AKfycbwzmtlb5NGCZM-vrMVwEr4xVXhCLnGW2FgWnVhz968vICSmDHCIo11WCVIGHXdWwjnp/exec";

    fetch(scriptURL, {
      method: "POST",
      body: formData,
    })
    .then(response => {
      if (!response.ok) throw new Error("Network error");
      summaryPage.style.display = 'none';
      document.getElementById("thankYouMessage").style.display = "block";
    })
    .catch(error => {
      alert("Something went wrong submitting your nomination. Please try again.");
      console.error(error);
    });
  }
</script>
